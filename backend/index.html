<head>
<script src="https://cdn.jsdelivr.net/gh/TarekRaafat/autoComplete.js@4.0.0/dist/js/autoComplete.min.js"></script>
<script>
    var xmlhttp = new XMLHttpRequest();
    var url = "http://localhost:3000/give-me-data";
    var item_list = []

    xmlhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            var item_obj = JSON.parse(this.responseText);
            item_list = item_obj.names;
            alert(item_list);
        }
    };

    xmlhttp.open("GET", url, true);
    xmlhttp.send();
</script>

<script>
    const autoCompletejs = new autoComplete({
      data: {
        src: async () => {
          // Loading placeholder text
          const source = await fetch("./give-me-data");
          const data = await source.json();
          // Returns Fetched data
          alert(data);
          return data;
        },
        key: ["names"]
      },
      selector: "#autoComplete",
      threshold: 1,
      searchEngine: "loose",
      highlight: true,
      maxResults: 5,
      resultsList: {
        container: source => {
          resultsListID = "autoComplete_results_list";
          return resultsListID;
        },
        destination: document.querySelector("#autoComplete"),
        position: "afterend"
      },
      resultItem: (data, source) => {
        return `${data.match}`;
      },
      onSelection: feedback => {
          /*
        const selection = feedback.selection.value.food;
        // Render selected choice to selection div
        document.querySelector(".selection").innerHTML = selection;
        // Clear Input
        document.querySelector("#autoComplete").value = "";
        // Change placeholder with the selected value
        document.querySelector("#autoComplete").setAttribute("placeholder", selection);
        // Concole log autoComplete data feedback
        console.log(feedback);
          */
        alert(feedback);
      }
    });

    window.addEventListener("load", () => {
      document.querySelector("#autoComplete").classList.add("out");
      document.querySelector("#autoComplete_results_list").style.display = "none";
    });
</script>
</head>

<body>
<div id="root">
    <form>
        <input type="text" name="name" id="autoComplete" tabindex="1">Name
        <br/>
        <input type="submit">
    </form>
</div>
</body>
